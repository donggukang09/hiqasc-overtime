# HIQASC 추가 근로 신청 시스템
## 설치 및 사용 가이드

**DEVELOPED BY DONGGU KANG**

---

## 📋 시스템 개요

### 주요 기능
1. **테크니션 신청 페이지** - 추가 근로 신청 (조근/야근/주말)
2. **관리자 승인 페이지** - 신청 승인/반려 처리
3. **자동 이메일 알림** - 신청 시 관리자에게, 승인/반려 시 신청자에게
4. **주간 집계** - 개인별 주당 최대 12시간 제한 관리
5. **Google Sheets 연동** - 모든 데이터 자동 저장 및 집계

### 근무 시간 규정
- **평일 조근**: 08:00 - 09:00 (1시간)
- **평일 야근**: 18:00 - 21:00 (1시간 단위 선택)
- **주말 근무**: 08:00 - 18:00 (1시간 단위 선택)
- **주간 최대**: 12시간

---

## 🚀 설치 방법

### 1단계: Google Sheets 생성

1. Google Drive에서 새 스프레드시트 생성
2. 이름: "HIQASC 추가근로관리" (또는 원하는 이름)

---

### 2단계: Google Apps Script 설정

1. **스프레드시트에서 확장 프로그램 > Apps Script 클릭**

2. **코드 복사 붙여넣기**
   - `overtime_system.gs` 파일의 전체 코드를 복사
   - Code.gs에 붙여넣기

3. **이메일 주소 설정 (중요!)**
   ```javascript
   const ADMIN_EMAIL = 'donggu.kang@hiqasc.kr'; // 동구님 이메일
   
   const TECH_EMAILS = {
     '강동구': 'donggu.kang@hiqasc.kr',
     '곽연학': 'yeonhak.kwak@hiqasc.kr',
     '김지수': 'jisoo.kim@hiqasc.kr',
     '김현관': 'hyeonkwan.kim@hiqasc.kr',
     '박준현': 'junhyeon.park@hiqasc.kr',
     '신준호': 'junho.shin@hiqasc.kr',
     '안정용': 'jungyoung.an@hiqasc.kr',
     '이대민': 'daemin.lee@hiqasc.kr',
     '이덕수': 'duksoo.lee@hiqasc.kr',
     '이동민': 'dongmin.lee@hiqasc.kr',
     '이상민': 'sangmin.lee@hiqasc.kr',
     '장균수': 'kyounsoo.jang@hiqasc.kr',
     '조성주': 'sungjoo.cho@hiqasc.kr',
     '최재웅': 'jaewoong.choi@hiqasc.kr'
   };
   ```
   ✅ 실제 이메일 주소가 이미 입력되어 있습니다!

4. **초기 시트 설정**
   - 함수 선택: `setupSheet`
   - 실행 버튼 클릭
   - 권한 승인 (처음 한 번만)

5. **웹 앱 배포**
   - 우측 상단 "배포" > "새 배포" 클릭
   - 유형 선택: "웹 앱"
   - 설정:
     * 설명: "HIQASC 추가근로 시스템 v1.0"
     * 실행 계정: "나"
     * 액세스 권한: "모든 사용자"
   - "배포" 클릭
   - **웹 앱 URL 복사** (중요!)

---

### 3단계: HTML 페이지 설정

#### 신청 페이지 (overtime_request.html)

1. 파일 열기
2. 다음 줄 찾기:
   ```javascript
   const SCRIPT_URL = 'YOUR_SCRIPT_URL_HERE';
   ```
3. 복사한 웹 앱 URL로 변경:
   ```javascript
   const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycby.../exec';
   ```

#### 승인 페이지 (overtime_approval.html)

1. 파일 열기
2. 동일하게 SCRIPT_URL 수정

---

### 4단계: 웹 호스팅 (선택사항)

**방법 1: Google Drive 공유**
- HTML 파일을 Google Drive에 업로드
- 공유 링크 생성

**방법 2: 사내 서버**
- 회사 웹 서버에 HTML 파일 업로드

**방법 3: GitHub Pages**
- GitHub에 리포지토리 생성
- Settings > Pages에서 활성화

---

## 📱 사용 방법

### 테크니션 (신청)

1. **신청 페이지 접속**
   - `overtime_request.html` 링크 클릭

2. **정보 입력**
   - 신청자: 드롭다운에서 이름 선택
   - 날짜: 추가 근로 날짜 선택
   - 근무 유형: 조근/야근/주말 선택
   - 시작/종료 시간: 자동으로 옵션 표시됨
   - 사유: 구체적으로 작성

3. **신청하기**
   - 주간 누적 시간 자동 확인
   - 12시간 초과 시 경고
   - 신청 완료 시 관리자에게 이메일 발송

### 관리자 (승인)

1. **승인 페이지 접속**
   - `overtime_approval.html` 링크 클릭

2. **신청 내역 확인**
   - 실시간 통계: 대기/승인/반려 건수
   - 필터: 상태별, 신청자별 필터링
   - 상세 정보: 날짜, 시간, 사유 확인

3. **승인/반려 처리**
   - 각 카드의 승인/반려 버튼 클릭
   - 확인 메시지 후 처리
   - 신청자에게 자동 이메일 발송

---

## 📊 Google Sheets 구조

### 컬럼 설명

| 컬럼 | 설명 | 자동/수동 |
|------|------|-----------|
| 신청일시 | 신청한 날짜와 시간 | 자동 |
| 신청자 | 테크니션 이름 | 입력 |
| 날짜 | 추가 근로 날짜 | 입력 |
| 근무유형 | 조근/야근/주말 | 입력 |
| 시작시간 | 근무 시작 시간 | 입력 |
| 종료시간 | 근무 종료 시간 | 입력 |
| 근무시간 | 총 시간 (시간) | 자동 계산 |
| 사유 | 추가 근로 사유 | 입력 |
| 상태 | 대기/승인/반려 | 자동 |
| 처리일시 | 승인/반려 처리 시간 | 자동 |
| 주차 | 년도-주차 (예: 2026-W02) | 자동 계산 |
| 주합계 | 해당 주 승인된 총 시간 | 자동 계산 |

### 상태별 색상

- **대기**: 주황색 배경
- **승인**: 초록색 배경
- **반려**: 빨간색 배경

---

## 📧 이메일 알림

### 신청 시 (→ 관리자)

```
제목: [HIQASC] 새로운 추가 근로 신청 - 이대민

안녕하세요, 강동구 매니저님

새로운 추가 근로 신청이 접수되었습니다.

━━━━━━━━━━━━━━━━━━━━━━━━━━
📋 신청 정보
━━━━━━━━━━━━━━━━━━━━━━━━━━

👤 신청자: 이대민
📅 날짜: 2026-01-15
⏰ 근무 유형: 야근
🕐 시간: 18:00 - 20:00 (2시간)
📝 사유: 백로그 처리를 위한 추가 작업

━━━━━━━━━━━━━━━━━━━━━━━━━━

승인 페이지에서 확인 및 처리해주세요.
```

### 승인/반려 시 (→ 신청자)

```
제목: [HIQASC] 추가 근로 신청 승인 - 2026-01-15

안녕하세요, 이대민님

귀하의 추가 근로 신청이 승인되었습니다 ✅

━━━━━━━━━━━━━━━━━━━━━━━━━━
📋 신청 정보
━━━━━━━━━━━━━━━━━━━━━━━━━━

📅 날짜: 2026-01-15
⏰ 근무 유형: 야근
🕐 시간: 18:00 - 20:00 (2시간)
📝 사유: 백로그 처리를 위한 추가 작업

━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ 최종 상태: 승인
━━━━━━━━━━━━━━━━━━━━━━━━━━

문의사항이 있으시면 관리자에게 연락해주세요.
```

---

## 🔧 고급 기능

### 주간 리포트 생성

Apps Script에서 `generateWeeklyReport()` 함수 실행

```javascript
// 이번 주 승인된 추가 근로 현황
{
  '강동구': 8,
  '이대민': 6,
  '장균수': 4
}
```

### 자동 주간 리포트 (선택사항)

1. Apps Script에서 트리거 설정
2. `generateWeeklyReport` 함수
3. 매주 금요일 17:00 실행

---

## 🛠️ 문제 해결

### 이메일이 안 가요
- ADMIN_EMAIL과 TECH_EMAILS 확인
- Gmail 설정에서 "덜 안전한 앱 액세스" 허용
- Apps Script 권한 재승인

### 주간 합계가 안 맞아요
- 승인된 건만 집계됨
- 같은 주차 (년도-주차) 기준
- 시트 새로고침 후 다시 확인

### 신청이 안 돼요
- SCRIPT_URL이 올바른지 확인
- 웹 앱 배포 시 "모든 사용자" 선택했는지 확인
- 브라우저 콘솔(F12)에서 에러 확인

---

## 📈 데이터 분석 팁

### 개인별 월간 통계
```
=QUERY(A:L, "SELECT B, SUM(G) WHERE I='승인' GROUP BY B")
```

### 부서 전체 주간 통계
```
=SUMIF(I:I, "승인", G:G)
```

### 유형별 통계
```
=QUERY(A:L, "SELECT D, COUNT(D), SUM(G) WHERE I='승인' GROUP BY D")
```

---

## 📞 지원

문제가 발생하거나 기능 추가가 필요하면 강동구에게 연락하세요.

**DEVELOPED BY DONGGU KANG © 2026 HIQASC**

---

## 📝 버전 히스토리

### v1.0 (2026-01-11)
- 초기 버전 출시
- 기본 신청/승인 기능
- 이메일 알림
- 주간 12시간 제한
- 자동 집계
